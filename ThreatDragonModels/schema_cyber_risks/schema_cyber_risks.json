{
  "version": "2.5.0",
  "summary": {
    "title": "Modèle de menaces - Architecture Système Complète",
    "owner": "Équipe Sécurité",
    "description": "Analyse complète des menaces cyber incluant l'infrastructure réseau, les applications, les bases de données, les utilisateurs et les vecteurs d'attaque",
    "id": 0
  },
  "detail": {
    "contributors": [
      {
        "name": "Équipe Sécurité"
      }
    ],
    "diagrams": [
      {
        "id": 0,
        "title": "Architecture Réseau et Menaces",
        "diagramType": "STRIDE",
        "placeholder": "Diagramme d'architecture complète",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.2.0",
        "cells": [
          {
            "position": {
              "x": 50,
              "y": 80
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Attaquant Externe"
              },
              "body": {
                "stroke": "#d32f2f",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 1,
            "id": "actor1",
            "data": {
              "type": "tm.Actor",
              "name": "Attaquant Externe",
              "description": "Acteur malveillant externe (APT, cybercriminels, hacktivistes) cherchant à compromettre le système via Internet",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 50,
              "y": 250
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Utilisateurs Légitimes"
              },
              "body": {
                "stroke": "#1976d2",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 2,
            "id": "actor2",
            "data": {
              "type": "tm.Actor",
              "name": "Utilisateurs Légitimes",
              "description": "Employés, partenaires et clients autorisés à accéder au système",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "threat_user1",
                  "title": "Compromission de compte utilisateur",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Les identifiants utilisateur peuvent être compromis par phishing, credential stuffing, ou brute force, permettant un accès non autorisé.",
                  "mitigation": "- MFA obligatoire\n- Politique de mots de passe robuste\n- Détection d'anomalies de connexion\n- Verrouillage après tentatives échouées\n- Formation anti-phishing",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 50,
              "y": 420
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Administrateurs"
              },
              "body": {
                "stroke": "#7b1fa2",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 3,
            "id": "actor3",
            "data": {
              "type": "tm.Actor",
              "name": "Administrateurs",
              "description": "Personnel IT avec privilèges élevés pour la gestion du système",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "threat_admin1",
                  "title": "Abus de privilèges administrateurs",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Comptes administrateurs compromis ou malveillants peuvent causer des dommages massifs au système.",
                  "mitigation": "- Principe du moindre privilège\n- Comptes admin séparés\n- PAM (Privileged Access Management)\n- Audit et logging complet\n- Approbation multi-personnes\n- Sessions enregistrées",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 350,
              "y": 50
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Firewall / WAF"
              },
              "body": {
                "stroke": "#f57c00",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 4,
            "id": "process1",
            "data": {
              "type": "tm.Process",
              "name": "Firewall / WAF",
              "description": "Pare-feu et Web Application Firewall protégeant le périmètre réseau",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "threat_fw1",
                  "title": "Scan réseau et reconnaissance",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Activités de cartographie (port scanning, banner grabbing, enumération) pour identifier les systèmes vulnérables. Impact DIC.",
                  "mitigation": "- IDS/IPS pour détecter scans\n- Rate limiting\n- Géo-blocking si applicable\n- Honeypots\n- Réduction de l'empreinte réseau\n- Bannières système masquées",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": ""
                },
                {
                  "id": "threat_fw2",
                  "title": "Contournement du firewall",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Techniques pour contourner les règles de firewall (tunneling, fragmentation, protocoles alternatifs).",
                  "mitigation": "- DPI (Deep Packet Inspection)\n- Règles strictes sortantes\n- Inspection SSL/TLS\n- Blocage de tunnels connus\n- Monitoring des flux anormaux",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 350,
              "y": 220
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Reverse Proxy / Load Balancer"
              },
              "body": {
                "stroke": "#0288d1",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 5,
            "id": "process2",
            "data": {
              "type": "tm.Process",
              "name": "Reverse Proxy / Load Balancer",
              "description": "Distribution de charge et proxy inverse pour les applications web",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "threat_proxy1",
                  "title": "Attaque DDoS",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Attaques par déni de service visant à saturer les ressources et rendre le service indisponible.",
                  "mitigation": "- Service anti-DDoS (Cloudflare, Akamai)\n- Rate limiting agressif\n- CAPTCHA adaptatif\n- Mise en cache CDN\n- Auto-scaling\n- Filtrage géographique",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 600,
              "y": 50
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Serveurs Web / API"
              },
              "body": {
                "stroke": "#388e3c",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 6,
            "id": "process3",
            "data": {
              "type": "tm.Process",
              "name": "Serveurs Web / API",
              "description": "Serveurs applicatifs hébergeant les applications web et APIs",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "threat_web1",
                  "title": "Exploitation de vulnérabilités applicatives (CVE)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Exploitation de failles connues (CVE) dans les frameworks, bibliothèques ou code custom : RCE, SQLi, XSS, SSRF, XXE, path traversal. Impact DIC.",
                  "mitigation": "- Gestion rigoureuse des patchs\n- Scan de vulnérabilités automatisé\n- SAST/DAST dans CI/CD\n- WAF avec règles OWASP\n- Principe du moindre privilège\n- Conteneurisation\n- Veille CVE active",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                },
                {
                  "id": "threat_web2",
                  "title": "Injection de code malveillant",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Injections SQL, XSS, Command Injection, LDAP injection permettant l'exécution de code malveillant.",
                  "mitigation": "- Validation stricte des entrées\n- Paramétrage des requêtes SQL\n- Échappement des sorties\n- CSP (Content Security Policy)\n- Utilisation d'ORM sécurisés\n- Revue de code sécurité",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                },
                {
                  "id": "threat_web3",
                  "title": "Mauvaise configuration système",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Serveurs mal configurés exposant des informations sensibles, services inutiles, permissions excessives. Impact DIC.",
                  "mitigation": "- Hardening selon CIS Benchmarks\n- Configuration management (Ansible, Puppet)\n- Scan de configuration\n- Désactivation services inutiles\n- Headers de sécurité HTTP\n- Chiffrement TLS 1.3+",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 600,
              "y": 220
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Serveur d'Application"
              },
              "body": {
                "stroke": "#5d4037",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 7,
            "id": "process4",
            "data": {
              "type": "tm.Process",
              "name": "Serveur d'Application",
              "description": "Couche métier et logique applicative",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "threat_app1",
                  "title": "Logique métier contournée",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Manipulation des workflows, bypass des contrôles métier, modification de prix ou quantités.",
                  "mitigation": "- Validation côté serveur obligatoire\n- Contrôles d'intégrité\n- Journalisation des transactions\n- Vérifications multi-niveaux\n- Tests de sécurité métier",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                },
                {
                  "id": "threat_app2",
                  "title": "Dépendances vulnérables",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Bibliothèques et frameworks tiers contenant des vulnérabilités connues (Log4Shell, etc.).",
                  "mitigation": "- SCA (Software Composition Analysis)\n- Mise à jour automatique dépendances\n- SBOM (Software Bill of Materials)\n- Snyk, Dependabot\n- Politique d'obsolescence",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 850,
              "y": 50
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Base de Données"
              },
              "body": {
                "stroke": "#c62828",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 8,
            "id": "store1",
            "data": {
              "type": "tm.Store",
              "name": "Base de Données",
              "description": "Système de gestion de base de données contenant les données sensibles",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": true,
              "isSigned": false,
              "storesCredentials": true,
              "storesInventory": false,
              "threats": [
                {
                  "id": "threat_db1",
                  "title": "Injection SQL",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Exploitation de failles d'injection pour exfiltrer, modifier ou détruire des données.",
                  "mitigation": "- Requêtes préparées obligatoires\n- ORM sécurisés\n- Principe du moindre privilège DB\n- WAF avec règles anti-SQLi\n- Monitoring des requêtes anormales",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": ""
                },
                {
                  "id": "threat_db2",
                  "title": "Exfiltration de données",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Vol de données sensibles (PII, credentials, données financières) par accès non autorisé.",
                  "mitigation": "- Chiffrement at-rest et in-transit\n- DLP (Data Loss Prevention)\n- Masquage de données\n- Monitoring des exports massifs\n- Contrôles d'accès stricts\n- Audit trail complet",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": ""
                },
                {
                  "id": "threat_db3",
                  "title": "Accès DB non autorisé",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Connexion directe à la DB en contournant l'application, via credentials compromis ou vulnérabilités.",
                  "mitigation": "- Segmentation réseau stricte\n- Pas d'accès Internet direct DB\n- Bastion/Jump host obligatoire\n- MFA pour accès admin DB\n- Rotation des credentials\n- Monitoring connexions",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 850,
              "y": 220
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Stockage Fichiers"
              },
              "body": {
                "stroke": "#6a1b9a",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 9,
            "id": "store2",
            "data": {
              "type": "tm.Store",
              "name": "Stockage Fichiers",
              "description": "Système de stockage de fichiers et documents (S3, NAS, etc.)",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": true,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "threat_storage1",
                  "title": "Upload de fichiers malveillants",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Upload de webshells, malwares, ou fichiers exploitant des vulnérabilités (zip bombs, XXE).",
                  "mitigation": "- Validation stricte des types MIME\n- Antivirus/sandbox scanning\n- Stockage hors webroot\n- Limitation taille fichiers\n- Renommage systématique\n- Quarantaine temporaire",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": ""
                },
                {
                  "id": "threat_storage2",
                  "title": "Accès non autorisé aux fichiers",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Accès à des fichiers d'autres utilisateurs via path traversal, IDOR, ou mauvaises ACL.",
                  "mitigation": "- Contrôles d'accès par utilisateur\n- Validation des chemins\n- URLs signées temporaires\n- Principe du moindre privilège\n- Audit des accès",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 15,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 600,
              "y": 390
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Système d'Authentification"
              },
              "body": {
                "stroke": "#01579b",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 10,
            "id": "process5",
            "data": {
              "type": "tm.Process",
              "name": "Système d'Authentification",
              "description": "Service d'authentification et gestion des identités (IAM, SSO, LDAP)",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "threat_auth1",
                  "title": "Attaques par phishing",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Campagnes d'ingénierie sociale (email, SMS, voice phishing) pour voler identifiants ou installer malwares. Impact DIC.",
                  "mitigation": "- Formation continue des utilisateurs\n- Simulations phishing régulières\n- Filtres anti-phishing avancés\n- MFA résistant au phishing (FIDO2)\n- Bannières emails externes\n- SPF/DKIM/DMARC\n- Signalement facile",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": ""
                },
                {
                  "id": "threat_auth2",
                  "title": "Credential stuffing / Brute force",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Utilisation de credentials volés ou attaques par force brute pour compromettre des comptes.",
                  "mitigation": "- MFA obligatoire\n- Rate limiting connexions\n- CAPTCHA après échecs\n- Blocage IP temporaire\n- Détection comptes compromis\n- Notification connexions suspectes",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 17,
                  "score": ""
                },
                {
                  "id": "threat_auth3",
                  "title": "Vulnérabilités SSO/OAuth",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Exploitation de failles dans l'implémentation SSO, OAuth, SAML pour contourner l'authentification.",
                  "mitigation": "- Validation stricte tokens\n- State parameter obligatoire\n- Vérification redirect_uri\n- Audit configuration SSO\n- Rotation des secrets\n- Monitoring authentifications",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 18,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 350,
              "y": 390
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Serveur Email"
              },
              "body": {
                "stroke": "#558b2f",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 11,
            "id": "process6",
            "data": {
              "type": "tm.Process",
              "name": "Serveur Email",
              "description": "Infrastructure de messagerie électronique",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "threat_email1",
                  "title": "Campagnes de phishing/spear phishing",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Emails frauduleux imitant des services légitimes ou personnalités pour voler des informations.",
                  "mitigation": "- Gateway anti-phishing avancé\n- Analyse des URLs et pièces jointes\n- Sandboxing des PJ\n- Machine learning détection phishing\n- Réécriture URLs\n- Quarantaine automatique",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 19,
                  "score": ""
                },
                {
                  "id": "threat_email2",
                  "title": "Malware via pièces jointes",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Distribution de malwares (ransomware, trojans, keyloggers) via pièces jointes infectées.",
                  "mitigation": "- Scan antivirus multicouche\n- Blocage extensions dangereuses\n- Sandboxing avancé\n- Désactivation macros par défaut\n- EDR sur les postes\n- Backup réguliers",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 20,
                  "score": ""
                },
                {
                  "id": "threat_email3",
                  "title": "Business Email Compromise (BEC)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Usurpation d'identité de dirigeants pour déclencher virements frauduleux ou vol de données.",
                  "mitigation": "- DMARC en mode reject\n- Validation domaines similaires\n- Procédures validation paiements\n- Formation ciblée finance/RH\n- Vérification hors-bande\n- Détection anomalies",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 21,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 850,
              "y": 390
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Logs & SIEM"
              },
              "body": {
                "stroke": "#f9a825",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 12,
            "id": "store3",
            "data": {
              "type": "tm.Store",
              "name": "Logs & SIEM",
              "description": "Système de collecte et analyse des logs de sécurité",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": true,
              "isEncrypted": true,
              "isSigned": true,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "threat_log1",
                  "title": "Suppression ou altération des logs",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Attaquants effaçant leurs traces en supprimant ou modifiant les logs d'activité.",
                  "mitigation": "- Logs centralisés immutables\n- Transfert temps réel\n- Signature cryptographique\n- Stockage WORM\n- Alertes modification logs\n- Séparation réseau",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 22,
                  "score": ""
                },
                {
                  "id": "threat_log2",
                  "title": "Absence de détection d'attaques",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Règles de détection inadéquates laissant passer des attaques sophistiquées.",
                  "mitigation": "- UEBA (User Entity Behavior Analytics)\n- Threat intelligence intégrée\n- ML pour détection anomalies\n- Règles SIGMA\n- SOC avec analystes\n- Purple teaming",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 23,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 100,
              "y": 580
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Insider Malveillant"
              },
              "body": {
                "stroke": "#d32f2f",
                "strokeWidth": 2,
                "strokeDasharray": "5,5"
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 13,
            "id": "actor4",
            "data": {
              "type": "tm.Actor",
              "name": "Insider Malveillant",
              "description": "Employé ou prestataire interne avec intentions malveillantes ou négligent",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "threat_insider1",
                  "title": "Vol de données par insider",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Employé exfiltrant des données sensibles pour profit personnel ou espionnage industriel.",
                  "mitigation": "- DLP avec contrôles exfiltration\n- Monitoring activités utilisateurs\n- Accès basé sur rôles strict\n- Background checks\n- Offboarding immédiat\n- Watermarking documents",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 24,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 600,
              "y": 560
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Système de Backup"
              },
              "body": {
                "stroke": "#4527a0",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 14,
            "id": "store4",
            "data": {
              "type": "tm.Store",
              "name": "Système de Backup",
              "description": "Infrastructure de sauvegarde et récupération des données",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": true,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "threat_backup1",
                  "title": "Ransomware ciblant les backups",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Attaquants détruisant ou chiffrant les backups pour empêcher la récupération après ransomware.",
                  "mitigation": "- Backups offline/air-gapped\n- Règle 3-2-1\n- Immutabilité des backups\n- Accès restreint aux backups\n- Tests restauration réguliers\n- MFA sur système backup",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": ""
                },
                {
                  "id": "threat_backup2",
                  "title": "Accès non autorisé aux backups",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Exposition de données sensibles via accès non contrôlé aux sauvegardes.",
                  "mitigation": "- Chiffrement fort des backups\n- Contrôles d'accès stricts\n- Audit des accès backups\n- Séparation réseau\n- Gestion des clés sécurisée",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 26,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 350,
              "y": 560
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Postes Utilisateurs"
              },
              "body": {
                "stroke": "#1565c0",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 15,
            "id": "process7",
            "data": {
              "type": "tm.Process",
              "name": "Postes Utilisateurs",
              "description": "Ordinateurs et dispositifs des employés",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "threat_endpoint1",
                  "title": "Malware sur endpoints",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Infection par ransomware, trojans, spyware via phishing, drive-by download, USB.",
                  "mitigation": "- EDR/XDR solution\n- Antivirus nouvelle génération\n- Application whitelisting\n- Désactivation macros\n- Patch management\n- USB blocking\n- Chiffrement disque",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 27,
                  "score": ""
                },
                {
                  "id": "threat_endpoint2",
                  "title": "Poste compromis pivot",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Utilisation d'un poste compromis pour mouvement latéral dans le réseau.",
                  "mitigation": "- Segmentation réseau\n- Zero Trust Network Access\n- EDR avec isolation\n- Principe moindre privilège\n- Network access control\n- Micro-segmentation",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 28,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 850,
              "y": 560
            },
            "size": {
              "width": 180,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Active Directory"
              },
              "body": {
                "stroke": "#0277bd",
                "strokeWidth": 2,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 16,
            "id": "process8",
            "data": {
              "type": "tm.Process",
              "name": "Active Directory",
              "description": "Service d'annuaire pour la gestion des identités Windows",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "threat_ad1",
                  "title": "Attaques AD (Kerberoasting, Golden Ticket)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Exploitation de failles AD pour élévation privilèges : Pass-the-Hash, DCSync, Kerberoasting, etc.",
                  "mitigation": "- Tiering model AD\n- Protected Users group\n- LAPS pour admin local\n- Audit AD régulier\n- ATA/Defender for Identity\n- Principe moindre privilège\n- Rotation mots de passe service",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 29,
                  "score": ""
                },
                {
                  "id": "threat_ad2",
                  "title": "Compromission Domain Admin",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Elevation of privilege",
                  "description": "Prise de contrôle totale du domaine via compromission compte Domain Admin.",
                  "mitigation": "- Comptes admin dédiés\n- PAW (Privileged Access Workstation)\n- MFA pour comptes admin\n- Sessions limitées temporellement\n- Monitoring comptes privilégiés\n- Red Forest architecture",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 30,
                  "score": ""
                }
              ]
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#d32f2f",
                "strokeWidth": 2,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 50,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Scans et exploits",
              "description": "Reconnaissance et exploitation de vulnérabilités",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": true,
              "protocol": "TCP/UDP",
              "threats": []
            },
            "id": "flow1",
            "source": {
              "id": "actor1"
            },
            "target": {
              "id": "process1"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 51,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Trafic filtré",
              "description": "Trafic après filtrage firewall",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "HTTPS",
              "threats": []
            },
            "id": "flow2",
            "source": {
              "id": "process1"
            },
            "target": {
              "id": "process2"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 52,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Requêtes distribuées",
              "description": "Distribution de charge vers serveurs",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "HTTPS",
              "threats": []
            },
            "id": "flow3",
            "source": {
              "id": "process2"
            },
            "target": {
              "id": "process3"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 53,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Appels métier",
              "description": "Communication avec couche applicative",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "Internal",
              "threats": []
            },
            "id": "flow4",
            "source": {
              "id": "process3"
            },
            "target": {
              "id": "process4"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#c62828",
                "strokeWidth": 2,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 54,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Requêtes SQL",
              "description": "Accès base de données",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "SQL/TLS",
              "threats": []
            },
            "id": "flow5",
            "source": {
              "id": "process4"
            },
            "target": {
              "id": "store1"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#6a1b9a",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 55,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Stockage fichiers",
              "description": "Upload/download de fichiers",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "S3/HTTPS",
              "threats": []
            },
            "id": "flow6",
            "source": {
              "id": "process3"
            },
            "target": {
              "id": "store2"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#1976d2",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 56,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Connexion utilisateur",
              "description": "Accès via navigateur",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "protocol": "HTTPS",
              "threats": []
            },
            "id": "flow7",
            "source": {
              "id": "actor2"
            },
            "target": {
              "id": "process2"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#d32f2f",
                "strokeWidth": 2,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": "5,5"
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 57,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Phishing emails",
              "description": "Campagnes de phishing ciblant utilisateurs",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": true,
              "protocol": "SMTP",
              "threats": []
            },
            "id": "flow8",
            "source": {
              "id": "actor1"
            },
            "target": {
              "id": "process6"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#558b2f",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 58,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Emails livrés",
              "description": "Emails après filtrage",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "IMAP/TLS",
              "threats": []
            },
            "id": "flow9",
            "source": {
              "id": "process6"
            },
            "target": {
              "id": "actor2"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#01579b",
                "strokeWidth": 2,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 59,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Authentification",
              "description": "Vérification identité",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "OAuth2/SAML",
              "threats": []
            },
            "id": "flow10",
            "source": {
              "id": "process3"
            },
            "target": {
              "id": "process5"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#7b1fa2",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 60,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Administration",
              "description": "Gestion système",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "SSH/RDP",
              "threats": []
            },
            "id": "flow11",
            "source": {
              "id": "actor3"
            },
            "target": {
              "id": "process3"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#f9a825",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 61,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Logs collectés",
              "description": "Agrégation des logs",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "Syslog/TLS",
              "threats": []
            },
            "id": "flow12",
            "source": {
              "id": "process3"
            },
            "target": {
              "id": "store3"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#f9a825",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 62,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Logs firewall",
              "description": "Logs sécurité réseau",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "Syslog",
              "threats": []
            },
            "id": "flow13",
            "source": {
              "id": "process1"
            },
            "target": {
              "id": "store3"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#4527a0",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 63,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Sauvegarde DB",
              "description": "Backup base de données",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "Internal",
              "threats": []
            },
            "id": "flow14",
            "source": {
              "id": "store1"
            },
            "target": {
              "id": "store4"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#1565c0",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 64,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Accès poste",
              "description": "Utilisateurs sur leurs postes",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "Local",
              "threats": []
            },
            "id": "flow15",
            "source": {
              "id": "actor2"
            },
            "target": {
              "id": "process7"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#0277bd",
                "strokeWidth": 2,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 65,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Auth AD",
              "description": "Authentification domaine",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "Kerberos/LDAPS",
              "threats": []
            },
            "id": "flow16",
            "source": {
              "id": "process7"
            },
            "target": {
              "id": "process8"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#0277bd",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 66,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Sync identités",
              "description": "Synchronisation des comptes",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "LDAPS",
              "threats": []
            },
            "id": "flow17",
            "source": {
              "id": "process8"
            },
            "target": {
              "id": "process5"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#d32f2f",
                "strokeWidth": 2,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": "5,5"
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 67,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Exfiltration",
              "description": "Vol de données",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "Various",
              "threats": []
            },
            "id": "flow18",
            "source": {
              "id": "actor4"
            },
            "target": {
              "id": "store1"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#f9a825",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 68,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Logs AD",
              "description": "Logs authentification",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "Syslog",
              "threats": []
            },
            "id": "flow19",
            "source": {
              "id": "process8"
            },
            "target": {
              "id": "store3"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#f9a825",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "classic"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 69,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Logs endpoints",
              "description": "Logs sécurité postes",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "Syslog",
              "threats": []
            },
            "id": "flow20",
            "source": {
              "id": "process7"
            },
            "target": {
              "id": "store3"
            }
          }
        ]
      }
    ],
    "diagramTop": 0,
    "reviewer": "Équipe Sécurité",
    "threatTop": 30
  }
}
